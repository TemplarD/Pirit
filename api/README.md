# GrinderMaster API

## üîí –ì–∏–±—Ä–∏–¥–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –ü—É–±–ª–∏—á–Ω—ã–π + IP-–∑–∞—â–∏—Ç–∞

### **üåê –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º –∫–ª–∏–µ–Ω—Ç–∞–º):**
- ‚úÖ `GET /api/health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
- ‚úÖ `GET /api/products` - —Ç–æ–≤–∞—Ä—ã
- ‚úÖ `GET /api/services` - —É—Å–ª—É–≥–∏  
- ‚úÖ `GET /api/categories` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ `POST /api/requests` - –∑–∞—è–≤–∫–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤

### **üîí –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (—Ç–æ–ª—å–∫–æ –ø–æ –±–µ–ª–æ–º—É IP):**
- üîí `POST /api/products` - —Å–æ–∑–¥–∞—Ç—å —Ç–æ–≤–∞—Ä
- üîí `POST /api/services` - —Å–æ–∑–¥–∞—Ç—å —É—Å–ª—É–≥—É
- üîí `POST /api/categories` - —Å–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- üîí `GET /api/admin/*` - –∞–¥–º–∏–Ω—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üîí `PUT /api/admin/requests/:id` - –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞—è–≤–∫—É

### **–§—É–Ω–∫—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- ‚úÖ **Rate limiting** - 100 –∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å –Ω–∞ IP
- ‚úÖ **White-list IP** - –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ **–í—Ä–µ–º–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø** - –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–π
- ‚úÖ **CORS** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- ‚úÖ **Security headers** - –∑–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫
- ‚úÖ **Redis –∫—ç—à** - —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üöÄ –ó–∞–ø—É—Å–∫

### **–õ–æ–∫–∞–ª—å–Ω–æ:**
```bash
cd api
npm install
npm run dev
```

### **Docker:**
```bash
docker-compose up api
```

## üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### **1. –ë–µ–ª—ã–π IP –≤ .env:**
```env
# –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π IP –≤ ALLOWED_IPS –≤ lib/db.ts
YOUR_WHITE_IP=123.45.67.89
```

### **2. –í—Ä–µ–º–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø:**
```bash
# –î–∞—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞ 1 —á–∞—Å
curl -X POST http://localhost:3000/api/admin/access \
  -H "Content-Type: application/json" \
  -d '{"ip": "123.45.67.89", "duration": 3600}'
```

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞:**
```bash
# Health check (–ø—É–±–ª–∏—á–Ω—ã–π)
curl http://localhost:3000/api/health

# –¢–æ–≤–∞—Ä—ã (–Ω—É–∂–µ–Ω —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π IP)
curl http://localhost:3000/api/products
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **–õ–æ–≥–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
```bash
# –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
üîí SECURITY: {"timestamp":"...","event":"RATE_LIMIT_EXCEEDED","details":{"ip":"..."}}

# –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø—ã
üîì Temporary access granted for IP: 123.45.67.89
```

### **Rate limiting:**
- **100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å** –Ω–∞ IP
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞** –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞** —á–µ—Ä–µ–∑ —á–∞—Å

## üåê –î–æ—Å—Ç—É–ø –∏–∑–≤–Ω–µ

### **–î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏:**
1. –£–∑–Ω–∞–π—Ç–µ —Å–≤–æ–π IP: `curl ifconfig.me`
2. –î–∞–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ API
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É: `http://YOUR_IP:3000`

### **–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø:**
1. –î–æ–±–∞–≤—å—Ç–µ IP –≤ `ALLOWED_IPS`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
3. –î–æ—Å—Ç—É–ø –æ—Ç–∫—Ä—ã—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
api/
‚îú‚îÄ‚îÄ lib/db.ts          # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö + –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
‚îú‚îÄ‚îÄ middleware.ts      # –ü—Ä–æ–≤–µ—Ä–∫–∞ IP + rate limiting
‚îú‚îÄ‚îÄ app/api/
‚îÇ   ‚îú‚îÄ‚îÄ health/        # Health check
‚îÇ   ‚îú‚îÄ‚îÄ products/      # –¢–æ–≤–∞—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ admin/access/  # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º
‚îú‚îÄ‚îÄ prisma/            # –°—Ö–µ–º–∞ –ë–î
‚îî‚îÄ‚îÄ Dockerfile         # –î–ª—è –¥–µ–ø–ª–æ—è
```

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

- **IP —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∞–¥—Ä–µ—Å–∞
- **Rate limiting** - 100 –∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å
- **CORS** - –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ–º–µ–Ω–æ–≤
- **Security headers** - XSS, CSRF –∑–∞—â–∏—Ç–∞
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞—Ç–∞–∫
- **Redis –∫—ç—à** - —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ë–î
