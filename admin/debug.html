<!DOCTYPE html>
<html>
<head>
    <title>Debug Admin Panel</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .error { color: red; background: #fee; padding: 10px; margin: 10px 0; }
        .success { color: green; background: #efe; padding: 10px; margin: 10px 0; }
        .info { color: blue; background: #eef; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>üîç Debug Admin Panel</h1>
    <div id="status"></div>
    
    <h2>üìä Connection Tests</h2>
    <button onclick="testAPI()">Test API Connection</button>
    <button onclick="testLogin()">Test Login</button>
    <button onclick="testLogs()">Test Logs</button>
    
    <div id="results"></div>
    
    <script>
        const status = document.getElementById('status');
        const results = document.getElementById('results');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            results.appendChild(div);
        }
        
        async function testAPI() {
            log('Testing API connection...', 'info');
            try {
                const response = await fetch('http://localhost:3000/api/health');
                const data = await response.json();
                log(`‚úÖ API OK: ${data.status}`, 'success');
            } catch (error) {
                log(`‚ùå API Error: ${error.message}`, 'error');
            }
        }
        
        async function testLogin() {
            log('Testing login...', 'info');
            try {
                const response = await fetch('http://localhost:3000/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: 'admin@grindermaster.ru',
                        password: 'admin123'
                    })
                });
                const data = await response.json();
                if (data.success) {
                    log(`‚úÖ Login OK: Token received`, 'success');
                } else {
                    log(`‚ùå Login Failed: ${data.error}`, 'error');
                }
            } catch (error) {
                log(`‚ùå Login Error: ${error.message}`, 'error');
            }
        }
        
        async function testLogs() {
            log('Testing logs...', 'info');
            try {
                const response = await fetch('http://localhost:3000/api/logs');
                const data = await response.json();
                log(`‚úÖ Logs OK: ${data.data.length} entries`, 'success');
                
                // Test sending a log
                await fetch('http://localhost:3000/api/logs', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        type: 'test',
                        action: 'debug_test',
                        userId: 'debug'
                    })
                });
                log(`‚úÖ Log sent successfully`, 'success');
            } catch (error) {
                log(`‚ùå Logs Error: ${error.message}`, 'error');
            }
        }
        
        // Check browser info
        log(`Browser: ${navigator.userAgent}`);
        log(`URL: ${window.location.href}`);
        
        // Auto-run tests
        setTimeout(testAPI, 1000);
        setTimeout(testLogin, 2000);
        setTimeout(testLogs, 3000);
    </script>
</body>
</html>
